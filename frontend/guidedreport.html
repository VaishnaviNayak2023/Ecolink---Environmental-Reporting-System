<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Guided Report | EcoLink</title>
  <link rel="stylesheet" href="guidedreports.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
    .step-section { display: none; }
    .step-section.active { display: block; }
    .card.selected { outline: 3px solid #1e5c46; }
    .btn-continue.disabled { opacity: 0.5; pointer-events: none; }
    #reviewMap { height: 200px; border-radius: 8px; margin-top:10px; }
    .success-box { padding: 16px; border-radius: 8px; background: #e6ffef; color: #0b5; }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <header class="navbar">
    <div class="logo" style="font-weight: 700; color: #1e5c46;">EcoLink</div>
    <nav class="nav-links">
        <a href="homepage.html">Home</a>
        <a href="#">About</a>
        <a href="report.html">Report Incident</a>
        <a href="#">Resources</a>
        <a href="#">Contact</a>
    </nav>
    <div class="nav-buttons">
      <a href="register.html" class="btn btn-signup">Sign Up</a>
      <a href="register.html" class="btn btn-login">Login</a>
    </div>
  </header>

  <!-- MAIN LAYOUT -->
  <main class="main-layout">

    <!-- LEFT SIDEBAR -->
    <aside class="sidebar">
      <h2>Report Incident</h2>
      <p class="subtitle">Complete all steps to submit your report</p>

      <ul class="steps">
        <li class="active" data-step="1">1. Category <span>Incident type and subtype</span></li>
        <li data-step="2">2. Location <span>Where did this occur?</span></li>
        <li data-step="3">3. Details <span>Checklist & description</span></li>
        <li data-step="4">4. Evidence <span>Photos and Documentation</span></li>
        <li data-step="5">5. Reporter Information <span>Contact Details</span></li>
        <li data-step="6">6. Review <span>Final check and submit</span></li>
      </ul>

      <div class="progress-section">
        <p>Progress</p>
        <div class="progress-bar">
          <div class="progress" id="progressBar" style="width: 16%;"></div>
        </div>
        <span class="progress-label" id="progressLabel">1 of 6</span>
      </div>

      <div class="draft-status">
        <p>Draft saved automatically</p>
      </div>
    </aside>

    <!-- RIGHT CONTENT SECTIONS -->

    <!-- STEP 1: CATEGORY -->
    <section id="step1" class="report-content step-section active">
      <h1>What type of incident are you reporting?</h1>
      <p class="description">Select the category that best describes the environmental issue.</p>

      <div class="category-grid">
        <div class="card" data-category="Oil Spill"><span></span><h3>Oil Spill</h3><p>Petroleum products, crude oil, or fuel spills</p></div>
        <div class="card" data-category="Chemical Release"><span></span><h3>Chemical Release</h3><p>Hazardous chemicals, toxic substances</p></div>
        <div class="card" data-category="Illegal Dumping"><span></span><h3>Illegal Dumping</h3><p>Unauthorized waste disposal, littering</p></div>
        <div class="card" data-category="Air Pollution"><span></span><h3>Air Pollution</h3><p>Smoke, emissions, odors, dust</p></div>
        <div class="card" data-category="Water Pollution"><span></span><h3>Water Pollution</h3><p>Contaminated water bodies, runoff</p></div>
        <div class="card" data-category="Environmental Damage"><span></span><h3>Environmental Damage</h3><p>Deforestation, habitat destruction</p></div>
      </div>

      <div class="button-row">
        <button class="btn-cancel">Cancel Report</button>
        <button class="btn-reset">Reset Report</button>
        <button class="btn-continue" id="toStep2">Continue to Location</button>
      </div>
    </section>

    <!-- STEP 2: LOCATION -->
    <section id="step2" class="report-content step-section">
      <h1>Where did this incident occur?</h1>
      <p class="description">Drag the pin on the map or enter the address to pinpoint the exact location</p>

      <form id="locationForm" class="location-form" onsubmit="return false;">
        <label for="searchAddress">Search Address</label>
        <input type="text" id="searchAddress" name="searchAddress" placeholder="Enter address" />

        <button type="button" class="btn-location" id="useLocationBtn">Use my current location</button>

        <div class="coordinate-fields">
          <input type="text" id="latitude" name="latitude" placeholder="Latitude" readonly />
          <input type="text" id="longitude" name="longitude" placeholder="Longitude" readonly />
        </div>

        <label for="landmark">Landmark Description (Optional)</label>
        <textarea id="landmark" name="landmark" rows="2" placeholder="e.g., Near a lake, behind the playground, next to the parking lot."></textarea>

        <!-- Removed Google iframe - using Leaflet map only -->
        <div class="map-section">
          <div id="map" style="height: 350px; border-radius: 10px;"></div>
        </div>

        <div class="button-row">
          <button type="button" class="btn-back" id="backToStep1">Back to Category</button>
          <button type="button" class="btn-continue" id="toStep3">Continue to Details</button>
          <button type="reset" class="btn-reset">Reset Report</button>
          <button type="button" class="btn-cancel">Cancel Report</button>
        </div>
      </form>
    </section>

    <!-- STEP 3: DETAILS -->
    <section id="step3" class="report-content step-section">
      <h1>Incident Details</h1>
      <p class="description">Provide specific details about the environmental impact and incident severity</p>

      <form id="detailsForm" class="details-form" onsubmit="return false;">
        <label>Observed Impacts</label>
        <p class="form-subtext">Select all impacts youâ€™ve observed at the incident site</p>

        <div class="impact-grid">
          <label class="impact-card"><input type="checkbox" name="impacts[]" value="Wildlife Harm"> <span>Harm to Wildlife</span> <small>Dead, injured or distressed animals</small></label>
          <label class="impact-card"><input type="checkbox" name="impacts[]" value="Air Pollution"> <span>Air Pollution</span> <small>Smoke, dust, emissions</small></label>
          <label class="impact-card"><input type="checkbox" name="impacts[]" value="Water Pollution"> <span>Water Pollution</span> <small>Contaminated water bodies</small></label>
          <label class="impact-card"><input type="checkbox" name="impacts[]" value="Chemical Release"> <span>Chemical Release</span> <small>Hazardous chemicals</small></label>
          <label class="impact-card"><input type="checkbox" name="impacts[]" value="Deforestation"> <span>Environmental Damage</span> <small>Habitat destruction</small></label>
          <label class="impact-card"><input type="checkbox" name="impacts[]" value="Illegal Dumping"> <span>Illegal Dumping</span> <small>Unauthorized waste disposal</small></label>
        </div>

        <label for="otherImpacts">Other Impacts</label>
        <input type="text" id="otherImpacts" name="otherImpacts" placeholder="Briefly describe what you observed..." />

        <label for="details">Detailed Description</label>
        <textarea id="details" name="details" rows="6" maxlength="1000" placeholder="Describe what you observed in detail..."></textarea>
        <small class="char-count" id="charCount">0 / 1000</small>

        <label for="severity">Severity Assessment</label>
        <select id="severity" name="severity">
          <option value="">Select severity level</option>
          <option value="Low">Low</option>
          <option value="Moderate">Moderate</option>
          <option value="High">High</option>
          <option value="Severe">Severe</option>
        </select>

        <label>Time of Occurrence (Optional)</label>
        <div class="datetime-fields">
          <input type="date" id="date" name="date">
          <input type="time" id="time" name="time">
        </div>

        <div class="button-row">
          <button type="button" class="btn-back" id="backToStep2">Back to Location</button>
          <button type="button" class="btn-continue" id="toStep4">Continue to Evidence</button>
          <button type="reset" class="btn-reset">Reset Report</button>
          <button type="button" class="btn-cancel">Cancel Report</button>
        </div>
      </form>
    </section>

    <!-- STEP 4: EVIDENCE -->
    <section id="step4" class="report-content step-section">
      <h1>Add Evidence</h1>
      <p class="description">Upload photos, videos, or documents that support your incident report</p>

      <form id="evidenceForm" method="POST" enctype="multipart/form-data" class="evidence-form" onsubmit="return false;">
        <div class="upload-box">
          <div class="upload-icon">ðŸ“·</div>
          <p class="upload-text">Drag and drop files here<br><span>or click to browse your device</span></p>
          <input type="file" id="fileUpload" name="evidence[]" multiple />
          <label for="fileUpload" class="btn-choose">Choose Files</label>
          <small class="file-support">Supported: JPG, PNG, MP4, MOV, PDF (Max 10MB each)</small>
        </div>

        <div class="file-list" id="fileList"></div>

        <div class="button-row">
          <button type="button" class="btn-back" id="backToStep3">Back to Details</button>
          <button type="button" class="btn-continue" id="toStep5">Continue to Reporter Info</button>
          <button type="reset" class="btn-reset">Reset Report</button>
          <button type="button" class="btn-cancel">Cancel Report</button>
        </div>
      </form>
    </section>

    <!-- STEP 5: REPORTER INFO -->
    <section id="step5" class="report-content step-section">
      <h1>Reporter Information</h1>
      <p class="description">Provide your contact details so we can follow up on your report if needed</p>

      <form class="reporter-form" onsubmit="return false;">
        <label for="fullname">Full Name <span class="required">*</span></label>
        <input type="text" id="fullname" name="fullname" placeholder="Enter your full name" required>

        <label for="email">Email Address <span class="required">*</span></label>
        <input type="email" id="email" name="email" placeholder="Enter your email address" required>

        <label for="phone">Phone Number (Optional)</label>
        <input type="tel" id="phone" name="phone" placeholder="e.g., +91 123 456 7890">
        <p class="form-subtext">For urgent follow-up communication only</p>

        <div class="data-info">
          <h4>How your data will be used</h4>
          <ul>
            <li class="ok">âœ” Contact you for clarification or additional information about your report</li>
            <li class="ok">âœ” Provide status updates on the investigation and resolution</li>
            <li class="ok">âœ” Verify details if the incident requires immediate response</li>
            <li class="no">âœ– Your information will never be shared with third parties</li>
            <li class="no">âœ– We do not use your data for marketing purposes</li>
          </ul>
        </div>

        <div class="button-row">
          <button type="button" class="btn-back" id="backToStep4">Back to Evidence</button>
          <button type="button" class="btn-continue" id="toStep6">Continue to Review</button>
          <button type="reset" class="btn-reset">Reset Report</button>
          <button type="button" class="btn-cancel">Cancel Report</button>
        </div>
      </form>
    </section>

    <!-- STEP 6: REVIEW -->
    <section id="step6" class="report-content step-section">
      <h1>Review Your Report</h1>
      <p class="description">Please review all information before submitting your environmental incident report.</p>

      <div class="accordion">
        <div class="accordion-item">
          <button class="accordion-header"><span>Category</span><span class="arrow">â€º</span></button>
          <div class="accordion-content">
            <div class="section-content">
              <p><strong>Category:</strong> <span id="review-category">â€”</span></p>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header"><span>Location</span><span class="arrow">â€º</span></button>
          <div class="accordion-content">
            <div class="section-content">
              <p><strong>Coordinates:</strong> <span id="review-location">â€”</span></p>
              <p><strong>Landmark:</strong> <span id="review-landmark">â€”</span></p>
              <div id="reviewMap"></div>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header"><span>Details</span><span class="arrow">â€º</span></button>
          <div class="accordion-content">
            <div class="section-content">
              <p><strong>Impacts:</strong> <span id="review-impacts">â€”</span></p>
              <p><strong>Description:</strong> <span id="review-description">â€”</span></p>
              <p><strong>Severity:</strong> <span id="review-severity">â€”</span></p>
              <p><strong>Date/Time:</strong> <span id="review-datetime">â€”</span></p>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header"><span>Evidence</span><span class="arrow">â€º</span></button>
          <div class="accordion-content">
            <div class="section-content">
              <p><strong>Files:</strong> <span id="review-files-count">0</span></p>
              <div id="review-files-list"></div>
            </div>
          </div>
        </div>

        <div class="accordion-item">
          <button class="accordion-header"><span>Reporter Information</span><span class="arrow">â€º</span></button>
          <div class="accordion-content">
            <div class="section-content">
              <p><strong>Name:</strong> <span id="review-name">â€”</span></p>
              <p><strong>Email:</strong> <span id="review-email">â€”</span></p>
              <p><strong>Phone:</strong> <span id="review-phone">â€”</span></p>
            </div>
          </div>
        </div>
      </div>

      <div class="confirmation-box">
        <label>
          <input type="checkbox" id="confirmCheckbox">
          I confirm that all the information provided in this report is accurate to the best of my knowledge.
        </label>
      </div>

      <div class="button-row">
        <button class="btn-back" id="backToStep5">Back to Reporter Info</button>
        <button class="btn-continue" id="submitReport">Submit Report</button>
      </div>

      <div id="submitResult" style="margin-top:12px;"></div>
    </section>

  </main>

  <footer></footer>

  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="guidedreport.js"></script>
</body>
</html>
